<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Polda App</title>

  <link rel="stylesheet" href="https://js.arcgis.com/4.7/esri/css/main.css">
  <script src="https://js.arcgis.com/4.7/"></script>

  <style>
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>



        <script>
          require([
              "esri/Map",
              "esri/views/MapView",
              "esri/WebMap",
              "esri/layers/FeatureLayer",
              "dojo/domReady!"

            ],
            function(
              Map, MapView,
              WebMap,
              FeatureLayer
            ) {

              var navmap = new WebMap({
                portalItem: { // autocasts as new PortalItem()
                  id: "8c195fcec6634b25b2302dcda07995f3"
                }
                });

              var navview = new MapView({
                container: "navDiv",
                map: navmap,

                //center: [ 106.8428588,-6.2498348],
                //zoom:10
              });

              navview.popup = true;


               var renderer = {
                 type: "simple", // autocasts as new SimpleRenderer()
                 symbol: {
                   type: "simple-marker", // autocasts as new SimpleMarkerSymbol()
                   size: 3,
                   color: "#fff6dd",
                   outline: { // autocasts as new SimpleLineSymbol()
                     color: [255, 196, 17, 0.4], // autocasts as new Color()
                     width: 4             }
                 }
               };

              var weather = new FeatureLayer({
                url: "http://52.148.81.212/asiangames-bmkg/featureserver/0",
                renderer: renderer,
                definitionExpression: "kota = 'Jakarta Pusat'",
                mode: FeatureLayer.MODE_ONDEMAND,
                refreshInterval: 0.3, //Set the interval to 1 minute

              });

              weather.outFields = ["*"];
              navmap.add(weather);
              navview.ui.components = [];

              //--------- interactivity



              navview.whenLayerView(weather).then(function(layerView){
                  layerView.watch("updating", function(val){
                    if(!val){  // wait for the layer view to finish updating
                      layerView.queryFeatures().then(function(results){
                        console.log(results.attributes);  // prints all the client-side graphics to the console


                      });
                    }
                  });
                });

  
      });
  </script>
</head>

<body>
  <div id="navDiv"></div>
</body>

</html>
